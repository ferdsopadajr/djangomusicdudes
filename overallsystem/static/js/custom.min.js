var track_id,track_max_duration,listening_duration,counter,fav_max,past_track=null,gen_rec=!0;$(function(){function a(){var a=1e3;listening_duration<1e3&&listening_duration>0&&(a=listening_duration),listening_duration-=a,width=100-listening_duration/track_max_duration*100,document.getElementById("playback-bar").style.width=width+"%",document.getElementById("playback-bar").setAttribute("aria-valuenow",track_max_duration-listening_duration),listening_duration<=0?clearInterval(counter):$.post("/convert_time/",{play_duration:track_max_duration-listening_duration},function(a){$("#play-duration").text(a)})}$.ajaxSetup({async:!1}),$(".sidebar-nav li:not(:first-child)").on("click","a",function(){$(this).parent().addClass("active").siblings().removeClass("active").find("i").css("color",""),$(this).find("i").css("color","#2b5b84"),$("#account").css("color","#fff"),"favorites"==$(this).attr("id")?$.post("/favorites/",function(a){$(".all-songs").html(a)}):"browse"==$(this).attr("id")?$.post("/browse/",function(a){$(".main-view").html(a)}):"spotify"==$(this).attr("id")&&$.post("/access_spotify/")}),$(".sidebar-nav").on("mouseover mouseout","li:nth-child(3)",function(){$(this).find("#create-playlist").toggleClass("sr-only")}),$("li:nth-child(3)").on("click","#create-playlist",function(){$('<div class="new-playlist"><img src="/static/icons/song-note.svg">This is a New Playlist</div>').appendTo(".playlists-title")}),$(".account").on("click","#reset-mood",function(){$.post("/reset_mood/")}),$(".main-view").on("click",".fa-play",function(){track_id=$(this).parent().attr("id"),$(".controls-bar").attr("id")&&(past_track=$(".controls-bar").attr("id")),past_track!=track_id&&(clearInterval(counter),$(this).addClass("sr-only").siblings(".fa-pause").removeClass("sr-only").parent().siblings(".song").find(".fa-pause").addClass("sr-only").siblings(".fa-play").removeClass("sr-only"),$.post("/upd_cbl/",{track_id:track_id},function(a){$(".controls-bar-left-center").html(a),$(".controls-bar").attr("id",track_id),$(".player-controls-buttons button").removeAttr("disabled")}),$.post("/disp_listens/",{track_id:track_id},function(a){$(".songs-container #"+track_id+" .listens").html(a)}),null!=past_track&&($.post("/add_to_pref/",{past_track:past_track,play_duration:track_max_duration-listening_duration,max_duration:track_max_duration}),$.post("/upd_rating/",{past_track:past_track,max_duration:track_max_duration},function(a){$("#"+past_track+" .ratings").text(a)}),track_max_duration-listening_duration>=track_max_duration/2&&$.post("/gen_rec/",{track_id:track_id},function(a){$(".all-songs").removeClass("full"),$(".mood-rec").removeClass("sr-only").html(a)})),$.post("/duration/",{track_id:track_id},function(a){listening_duration=track_max_duration=a})),counter=setInterval(a,1e3),$(this).addClass("sr-only").siblings(".fa-pause").removeClass("sr-only").parent().siblings(".song").find(".fa-pause").addClass("sr-only").siblings(".fa-play").removeClass("sr-only"),$(".player-controls-buttons .fa-play").addClass("sr-only").siblings(".fa-pause").removeClass("sr-only")}).on("click",".fa-pause",function(){clearInterval(counter),$(this).addClass("sr-only").siblings(".fa-play").removeClass("sr-only"),$(".player-controls-buttons .fa-pause").addClass("sr-only").siblings(".fa-play").removeClass("sr-only")}),$(".main-view").on("click",".fal.fa-heart",function(){track_id=$(this).parents(".song").attr("id"),$.post("/duration/",{track_id:track_id},function(a){fav_max=a}),$.post("/add_to_fav/",{track_id:track_id,max_duration:fav_max}),$.post("/upd_rating/",{track_id:track_id,max_duration:fav_max},function(a){$("#"+track_id+" .ratings").text(a)}),$.post("/gen_rec/",{track_id:track_id},function(a){$(".all-songs").removeClass("full"),$(".mood-rec").removeClass("sr-only").html(a)}),$(this).addClass("sr-only").siblings(".fas.fa-heart").removeClass("sr-only"),$(".controls-bar").attr("id")==track_id&&$(".controls-bar-left .fal.fa-heart").addClass("sr-only").siblings(".fas.fa-heart").removeClass("sr-only")}).on("click",".fas.fa-heart",function(){track_id=$(this).parents(".song").attr("id"),$.post("/del_to_fav/",{track_id:track_id},function(a){"False"==a&&(fav_max=0,$(".all-songs").addClass("full"),$(".mood-rec").addClass("sr-only"))}),$.post("/upd_rating/",{track_id:track_id,max_duration:fav_max},function(a){"0%"==a&&(gen_rec=!1),$("#"+track_id+" .ratings").text(a)}),1==gen_rec&&$.post("/gen_rec/",{track_id:track_id},function(a){}),$(this).addClass("sr-only").siblings(".fal.fa-heart").removeClass("sr-only"),$(".controls-bar").attr("id")==track_id&&$(".controls-bar-left .fas.fa-heart").addClass("sr-only").siblings(".fal.fa-heart").removeClass("sr-only")}),$(".controls-bar-left-center").on("click",".fal.fa-heart",function(){track_id=$(this).parents(".controls-bar").attr("id"),$.post("/duration/",{track_id:track_id},function(a){fav_max=a}),$.post("/add_to_fav/",{track_id:track_id,max_duration:fav_max}),$.post("/upd_rating/",{track_id:track_id,max_duration:fav_max},function(a){$("#"+track_id+" .ratings").text(a)}),$.post("/gen_rec/",{track_id:track_id},function(a){$(".all-songs").removeClass("full"),$(".mood-rec").removeClass("sr-only").html(a)}),$(this).addClass("sr-only").siblings(".fas.fa-heart").removeClass("sr-only"),$(".main-view").find("div#"+track_id).find(".fal.fa-heart").addClass("sr-only").siblings(".fas.fa-heart").removeClass("sr-only")}).on("click",".fas.fa-heart",function(){track_id=$(this).parents(".controls-bar").attr("id"),$.post("/del_to_fav/",{track_id:track_id},function(a){"False"==a&&(fav_max=0,$(".all-songs").addClass("full"),$(".mood-rec").addClass("sr-only"))}),$.post("/upd_rating/",{track_id:track_id,max_duration:fav_max},function(a){"0%"==a&&(gen_rec=!1),$("#"+track_id+" .ratings").text(a)}),1==gen_rec&&$.post("/gen_rec/",{track_id:track_id},function(a){}),$(this).addClass("sr-only").siblings(".fal.fa-heart").removeClass("sr-only"),$(".main-view").find("div#"+track_id).find(".fas.fa-heart").addClass("sr-only").siblings(".fal.fa-heart").removeClass("sr-only")}),$(".controls-bar-left-center").on("click",".fa-pause",function(){clearInterval(counter),$(this).addClass("sr-only").siblings(".fa-play").removeClass("sr-only"),$(".main-view").find("div#"+track_id).find(".fa-pause").addClass("sr-only").siblings(".fa-play").removeClass("sr-only")}).on("click",".fa-play",function(){counter=setInterval(a,1e3),$(this).addClass("sr-only").siblings(".fa-pause").removeClass("sr-only"),$(".main-view").find("div#"+track_id).find(".fa-play").addClass("sr-only").siblings(".fa-pause").removeClass("sr-only")}).on("click",".fa-random, .fa-repeat-alt",function(){$(this).hasClass("but-clkd")?($(this).removeClass("but-clkd"),"Disable shuffle"==$(this).attr("title")&&$(this).attr("title","Enable shuffle")):($(this).addClass("but-clkd"),"Enable repeat"==$(this).attr("title")?$(this).attr("title","Enable repeat one"):"Enable shuffle"==$(this).attr("title")&&$(this).attr("title","Disable shuffle"))}).on("click",".fa-repeat-alt.but-clkd",function(){$(this).attr("title","Enable repeat"),$(this).removeClass("but-clkd").addClass("sr-only").siblings(".fa-repeat-1-alt").removeClass("sr-only").addClass("but-clkd")}).on("click",".fa-repeat-1-alt",function(){$(this).removeClass("but-clkd").addClass("sr-only").siblings(".fa-repeat-alt").removeClass("sr-only")}),$(".cr_pl").on("click","#account",function(){$(this).css("color","#fed667"),$(".sidebar-nav").children().removeClass("active"),$.post("/account/",function(a){$(".main-view").html(a)})})});